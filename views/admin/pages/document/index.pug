extends ../../layouts/default.pug

block main
  .user-management-content
    //- Header Section
    .header-section
      .header-title
        h1.page-title Danh sách tài liệu
      .header-actions
        a.btn-add(href="/admin/document/create")
          | Thêm Tài liệu mới

    //- Table Container  
    .table-container
      table.document-table
        thead.table-header
          tr
            th ID
            th Tên Tài Liệu  
            th Danh Mục
            th Người Đăng
            th Ngày Tạo
            th Thao Tác
        
        tbody.table-body
          if documents && documents.length > 0
            each doc in documents
              tr.table-row
                td= doc.id
                td= doc.title
                td
                  if doc.categories && doc.categories.length > 0
                    .category-list
                      each category in doc.categories
                        span.category-badge(class=`category-${category.id}`)
                          = category.name
                          
                  else
                    | Chưa phân loại
                td= doc.author
                td= doc.createdAt
                td
                  .btn-group
                    // Thay thế nút view bằng nút toggle status
                    button.btn-action.btn-toggle-status(
                      data-id=doc.id
                      data-status=doc.status || 'active'
                      title=doc.status === 'active' ? 'Click để ẩn tài liệu' : 'Click để hiện tài liệu'
                    )
                      i.fas(class=doc.status === 'active' ? 'fa-eye' : 'fa-eye-slash')
                    a.btn-action.btn-edit(href=`/admin/document/edit/${doc.id}`)
                      i.fas.fa-edit   
                    button.btn-action.btn-delete(data-id=doc.id)
                      i.fas.fa-trash
          else
            tr
              td(colspan="6" style="text-align: center") Không có dữ liệu

    //- Phân trang
    if pagination && pagination.totalPages > 1
      .pagination-container
        .pagination
          //- Nút Trang trước
          if pagination.page > 1
            a.btn-page.btn-prev(href=`/admin/document?page=${pagination.page - 1}`) 
              i.fas.fa-angle-double-left
              

          //- Số trang
          - var i = 1;
          while i <= pagination.totalPages
            if i === pagination.page
              button.btn-page.active= i
            else
              a.btn-page(href=`/admin/document?page=${i}`)= i
            - i++

          //- Nút Trang sau
          if pagination.page < pagination.totalPages
            a.btn-page.btn-next(href=`/admin/document?page=${pagination.page + 1}`)
              
              i.fas.fa-angle-double-right
  script(src="/admin/js/scriptN.js")