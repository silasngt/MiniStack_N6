extends ../../layouts/default.pug
include ../../mixins/pagination.pug
block main
    .post-management-content
        //- Header Section
        .header-section
            h1.page-title Danh sách bài viết
            a.btn-add-post(href="/admin/posts/create") Thêm bài viết mới
        //- Success messages
        if success === 'created'
            .alert.alert-success ✅ Bài viết đã được tạo thành công!
        if success === 'updated'
            .alert.alert-success ✅ Bài viết đã được cập nhật thành công!
        if success === 'deleted'
            .alert.alert-success ✅ Bài viết đã được xóa thành công!

        //- Post Table
        .table-container
            table.post-table
                thead
                    tr
                        th STT
                        th Tiêu đề
                        th Nội dung
                        th Tác giả
                        th Danh mục
                        th Ngày tạo
                        th Thao tác

                tbody
                    if posts && posts.length > 0
                        each post,index in posts
                            tr.post-row(
                                id=`post-row-${post.PostID}` 
                                class=post.status === 'inactive' ? 'post-inactive' : ''
                            )
                                td.post-id= index + 1
                                td.post-title.truncate(title=post.Title)= post.Title
                                td.post-content.truncate(title=post.Content)= post.Content
                                td.post-author= post.authorName
                                td.post-category= post.categoryNames || 'Chưa phân loại'
                                td.post-date= post.formattedDate
                                td.post-actions
                                    .btn-group(role="group")
                                        button.btn.btn-outline-secondary.btn-sm(
                                            title=post.status === 'active' ? 'Tạm dừng bài viết' : 'Kích hoạt bài viết'
                                            onclick=`togglePostStatus(${post.PostID})`
                                            data-post-id=post.PostID
                                            data-status=post.status
                                            class=post.status === 'inactive' ? 'btn-status-inactive' : 'btn-status-active'
                                        )
                                            if post.status === 'active'
                                                i.fas.fa-eye
                                            else
                                                i.fas.fa-eye-slash
                                        button.btn.btn-outline-primary.btn-sm(title="Chỉnh sửa" onclick=`editPost(${post.PostID})`)
                                            i.fas.fa-pencil-alt
                                        button.btn.btn-outline-danger.btn-sm(title="Xóa" onclick=`deletePost(${post.PostID})`)
                                            i.fas.fa-trash
                    else
                        tr
                            td(colspan="9" style="text-align: center; padding: 40px; color: #999;")
                                i.fas.fa-inbox(style="font-size: 3rem; margin-bottom: 15px; display: block;")
                                div Chưa có bài viết nào
                                a.btn-add-post(href="/admin/posts/create" style="margin-top: 15px; display: inline-block;") Thêm bài viết đầu tiên

        +pagination(currentPage, totalPages)

    script(src="/admin/js/scriptK.js")
